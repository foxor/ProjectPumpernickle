using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Runtime.Serialization.Json;
using System.Text;
using System.Threading.Tasks;

namespace ProjectPumpernickle {
    internal class RelicFunctions {
        public static float BurningBlood(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float CrackedCore(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PureWater(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float RingoftheSnake(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Akabeko(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Anchor(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float AncientTeaSet(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float ArtofWar(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BagofMarbles(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BagofPreparation(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BloodVial(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BronzeScales(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float CentennialPuzzle(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float CeramicFish(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Damaru(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float DataDisk(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float DreamCatcher(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float HappyFlower(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float JuzuBracelet(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Lantern(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MawBank(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MealTicket(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Nunchaku(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float OddlySmoothStone(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Omamori(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Orichalcum(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PenNib(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PotionBelt(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PreservedInsect(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float RedSkull(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float RegalPillow(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float SmilingMask(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float SnakeSkull(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Strawberry(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Boot(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float TinyChest(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float ToyOrnithopter(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Vajra(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float WarPaint(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Whetstone(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BlueCandle(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BottledFlame(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BottledLightning(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BottledTornado(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float DarkstonePeriapt(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Yang(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float EternalFeather(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float FrozenEgg2(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Cables(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float GremlinHorn(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float HornCleat(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float InkBottle(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Kunai(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float LetterOpener(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Matryoshka(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MeatontheBone(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MercuryHourglass(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MoltenEgg2(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MummifiedHand(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float NinjaScroll(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float OrnamentalFan(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Pantograph(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PaperCrane(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PaperFrog(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Pear(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float QuestionCard(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float SelfFormingClay(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Shuriken(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float SingingBowl(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float StrikeDummy(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Sundial(Relic r) {
            var value = r.bias;
            if (Save.state.relics.Contains("Snecko Eye")) {
                return 0f;
            }
            Save.state.buildingInfinite = true;
            var cardDraw = Evaluators.GetCardDrawCards().Where(x => x.intCost < 2);
            var drawCount = cardDraw.Count();
            var twoCard = cardDraw.Where(x => x.intCost == 1 && x.tags[Tags.CardDraw.ToString()] >= 2f);
            var oneCard = cardDraw.Where(x => x.intCost == 1 && x.tags[Tags.CardDraw.ToString()] < 2f);
            var cantrip = cardDraw.Where(x => x.intCost == 0);
            var cardsToAdd = 0;
            if (!cardDraw.Any()) {
                cardsToAdd = 2;
            }
            else if (twoCard.Any() && oneCard.Any()) {
                cardsToAdd = 0;
            }
            else if (cantrip.Any() && (oneCard.Any() || twoCard.Any())) {
                cardsToAdd = 0;
            }
            else {
                cardsToAdd = 1;
            }
            Save.state.infiniteMaxSize = 10;
            Save.state.earliestInfinite = 1;
            Save.state.missingCardCount = cardsToAdd;
            if (cardsToAdd > 0) {
                Save.state.HuntForCard("Shrug It Off");
                Save.state.HuntForCard("Pommel Strike");
            }
            Save.state.infiniteDoesDamage = cardDraw.Any(x => x.tags.ContainsKey(Tags.Damage.ToString()));
            Save.state.infiniteBlockPerCard = cardDraw.Select(x => x.tags.GetValueOrDefault(Tags.Block.ToString())).OrderByDescending(x => x).Take(2).Sum() / 2f;
            return value;
        }
        public static float SymbioticVirus(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float TeardropLocket(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float TheCourier(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float ToxicEgg2(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float WhiteBeastStatue(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BirdFacedUrn(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Calipers(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float CaptainsWheel(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float ChampionBelt(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float CharonsAshes(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float CloakClasp(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float DeadBranch(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float DuVuDoll(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float EmotionChip(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float FossilizedHelix(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float GamblingChip(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Ginger(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Girya(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float GoldenEye(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float IceCream(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float IncenseBurner(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float LizardTail(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MagicFlower(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Mango(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float OldCoin(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PeacePipe(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Pocketwatch(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PrayerWheel(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Shovel(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float StoneCalendar(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float TheSpecimen(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float ThreadandNeedle(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Tingsha(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Torii(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float ToughBandages(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float TungstenRod(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Turnip(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float UnceasingTop(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float WingedGreaves(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BloodyIdol(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Circlet(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float CultistMask(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Enchiridion(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float FaceOfCleric(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float GoldenIdol(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float GremlinMask(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MarkoftheBloom(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MutagenicStrength(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float NlothsGift(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float NlothsMask(Relic r) {
            var value = r.bias;
            return value;
        }
        public static readonly float NECRO_ACTIVE_FLOOR = 2.2f;
        public static readonly float NECRO_PER_CARD = 0.4f;
        public static readonly float NECRO_MAX = 6f;
        public static float Necronomicon(Relic r) {
            var targets = Evaluators.NecronomiconTargets();
            if (!targets.Any()) {
                return r.bias;
            }
            var value = NECRO_ACTIVE_FLOOR + NECRO_PER_CARD * targets.Count();
            return MathF.Min(value, NECRO_MAX);
        }
        public static float NeowsBlessing(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float NilrysCodex(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float OddMushroom(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float RedCirclet(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float RedMask(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float SpiritPoop(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float SsserpentHead(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float WarpedTongs(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Astrolabe(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BlackBlood(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BlackStar(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float BustedCrown(Relic r) {
            var value = r.bias;
            var infiniteOnline = RewardInfinite.CurrentInfiniteRoom() > 0;
            if (infiniteOnline) {
                return 3f;
            }
            return value;
        }
        public static float CallingBell(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float CoffeeDripper(Relic r) {
            var value = r.bias;
            var maxHpFactor = 68f / Evaluation.Active.Path.expectedMaxHealth[^1];
            return value * maxHpFactor;
        }
        public static float CursedKey(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Ectoplasm(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float EmptyCage(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float FrozenCore(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float FusionHammer(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float HolyWater(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float HoveringKite(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Inserter(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MarkofPain(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float NuclearBattery(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PandorasBox(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PhilosophersStone(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float RingoftheSerpent(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float RunicCube(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float RunicDome(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PyramidAnswerConsistencyBonus() {
            var answerScore = Evaluation.Active.InternalScores[(int)ScoreReason.GoodAnswers];
            return answerScore / (answerScore + 1.5f);
        }
        public static float PyramidHandComboBonus() {
            var synergyPayoffs = Save.state.cards
                .Select(c => c.payoff.Keys.Select(p => Enum.Parse<ScoreReason>(p)))
                .Merge()
                .Distinct();
            var synergyScore = synergyPayoffs.Select(x => Evaluation.Active.InternalScores[(int)x]).Sum();
            return synergyScore / (synergyScore + 0.8f);
        }
        public static readonly int PYRAMID_WORST_CARDS_HELD_WHILE_SHUFFLING = 5;
        public static float PyramidShuffleDensityBonus() {
            var permanentCards = Evaluators.PermanentCards();
            var totalDeckScore = permanentCards.Select(x => x.evaluatedScore).Sum();
            var permanentDeckSize = permanentCards.Count();
            if (permanentDeckSize == 0) {
                return 0f;
            }
            var scorePerCard = totalDeckScore / permanentDeckSize;
            var skippedCards = PYRAMID_WORST_CARDS_HELD_WHILE_SHUFFLING + (int)Evaluators.PermanentDeckSizeOffset();
            var shuffledCardCount = Math.Max(1, permanentDeckSize - skippedCards);
            var shuffleSkipCount = permanentDeckSize - shuffledCardCount;
            var shuffleCards = permanentCards.OrderBy(x => x.evaluatedScore).Skip(shuffleSkipCount);
            var shuffleDeckScore = shuffleCards.Select(x => x.evaluatedScore).Sum();
            var scorePerShuffledCard = shuffleDeckScore / shuffledCardCount;
            var shuffleDeckAverageScoreDelta = scorePerShuffledCard - scorePerCard;
            return shuffleDeckAverageScoreDelta / (shuffleDeckAverageScoreDelta + 0.3f);
        }
        public static float RunicPyramid(Relic r) {
            var value = 0f;
            value += PyramidAnswerConsistencyBonus() * 6f;
            value += PyramidHandComboBonus() * 6f;
            value += PyramidShuffleDensityBonus() * 6f;
            return value;
        }
        public static float SacredBark(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float SlaversCollar(Relic r) {
            var value = r.bias;
            return value;
        }
        public static readonly float SNECKO_OFFSET = 6f;
        public static float SneckoEye(Relic r) {
            var netCost = 0f;
            foreach (var card in Save.state.cards) {
                if (card.intCost == int.MaxValue) {
                    continue;
                }
                netCost += 1.5f - card.intCost;
            }
            var expectedCardsPlayed = Evaluators.AverageCardsPerFight();
            var playsPerCard = expectedCardsPlayed / Save.state.cards.Count;
            return -netCost * Scoring.VALUE_PER_NET_SAVING * playsPerCard + SNECKO_OFFSET;
        }
        public static float Sozu(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float TinyHouse(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float VelvetChoker(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float VioletLotus(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float WristBlade(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Brimstone(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Cauldron(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float ChemicalX(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float ClockworkSouvenir(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float DollysMirror(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float FrozenEye(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float HandDrill(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float LeesWaffle(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MedicalKit(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Melange(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float MembershipCard(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float OrangePellets(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Orrery(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float PrismaticShard(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float RunicCapacitor(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Sling(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float StrangeSpoon(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float TheAbacus(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float Toolbox(Relic r) {
            var value = r.bias;
            return value;
        }
        public static float TwistedFunnel(Relic r) {
            var value = r.bias;
            return value;
        }
    }
}
